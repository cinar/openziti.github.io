<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Enrolling an Identity | Ziti </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Enrolling an Identity | Ziti ">
    <meta name="generator" content="docfx 2.x">
    
    <link rel="shortcut icon" href="../../images/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
    <!--span>this is text</span-->
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;0,700;1,400&amp;display=swap" rel="stylesheet">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/ziti-logo-40.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div style="display: flex;">
                    <div class="form-group" style="valign: center;position: relative;">
                      <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                    </div>
                    <div style="position: relative">
                        &nbsp;
                    </div>
                    <div style="position: relative">
                        <a href="https://github.com/openziti">
                            <img src="../../images/github-white.svg" alt="Star us on GitHub" title="Star us on GitHub" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://openziti.discourse.group">
                            <img src="../../images/discourse_icon_halo.svg" alt="Start a conversation on Discourse" title="Start a conversation on Discourse" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://twitter.com/openziti">
                            <img src="../../images/twit.svg" alt="Follow us on Twitter" title="Follow us on Twitter" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://www.youtube.com/channel/UCAsrfQasdZmp2Gq07Ej_5cQ">
                            <img src="../../images/yt.svg" alt="Watch videos about OpenZiti" title="Watch videos about OpenZiti" height="34px">
                        </a>
                    </div>
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default" name="new">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
          <div style="display:flex; align-items: center; justify-content: center; flex-direction:row; position: relative; width: 100%; text-align: center;     background: rgb(0,104,247);
            background: linear-gradient(90deg, rgba(0,104,247,1) 0%, rgba(222,14,91,1) 100%);">
            <span style="margin-top: 5px; color: white; margin-right: 10px; height:25px">Star us on GitHub</span>
            <span style="margin-top: 5px;"><a class="github-button" href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star openziti/ziti on GitHub">Star</a></span>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h2 id="enrolling-an-identity">Enrolling an Identity</h2>

<p>All connections made to the Ziti network leverage <a href="https://en.wikipedia.org/wiki/Mutual_authentication">mutual TLS</a>
which means every client needs a valid X509 certificate which it will present to the Ziti network during the connection
process. The process of obtaining a key/certificate pair and presenting it securely to the Ziti Controller is called
&quot;Enrollment&quot;.</p>
<h3 id="overview">Overview</h3>
<p>All identities need to be enrolled with the Ziti Controller so the Ziti Controller can authenticate the incoming connection.
This process is slightly different for each type of identity and is complex. The easiest way to enroll an identity is to 
use either the Ziti Desktop Edge/Ziti Mobile Edge for your operating system. Alternatively, you may perform the enrollment separate with the <code>ziti</code> CLI:</p>
<ul>
<li><a href="https://github.com/openziti/ziti/releases/latest">Linux, MacOS, Windows</a></li>
</ul>
<h3 id="one-time-token-enrollment---internal-pki">One Time Token Enrollment - Internal PKI</h3>
<p>Perhaps the easiest path to an enrolled identity is by using the one-time token enrollment flow. This flow leverages the
PKI configured in the Ziti Controller.  Using the one-time token flow - the <code>ziti</code> CLI will generate a private key
and a certificate signing request for the Ziti Controller&#39;s built-in certificate authority to fulfill.</p>
<p>Follow these steps to enroll an identity with a one-time token:</p>
<ul>
<li><a href="creating.html">create the Identity</a></li>
<li>download or copy the JWT - this file contains the single use token</li>
<li>run <code>ziti</code> :</li>
</ul>
<p><strong>Example Usage:</strong></p>
<pre><code>ziti edge enroll \
    --jwt ${jwt_file} \
    --out ${identity_config_file}
</code></pre><div class="IMPORTANT"><h5>Important</h5><p>The output from the <code>ziti</code> is a permanent identity configuration file which
must be stored securely. This file contains within it the private key that backs
the certificate issued by the Ziti Controller.  This file should not be
transferred or shared and should not be moved from the machine unless you are
confident you understand the risks involved in doing so.</p>
</div>
<h3 id="3rd-party-ca---one-time-token">3rd Party CA - One Time Token</h3>
<p>This process is similar to the One Time Token flow from above. This flow expects that a private key and certificate have
already been created on or distributed to the machine that is about to enroll and that the certificate presented is
signed by a <a href="../manage/pki.html#third-party-ca-optional">third party CA</a> already validated in the Ziti Controller.</p>
<p>Follow these steps to enroll a 3rd Pary CA - one-time token identity:</p>
<ul>
<li><a href="creating.html">create the Identity</a></li>
<li>download or copy the JWT - this file contains the one-time token</li>
<li>run the <code>ziti-tunneler</code> for your given operating system. Notice you can provide the name of the identity :</li>
</ul>
<p><strong>Example Usage:</strong></p>
<pre><code>ziti edge enroll \
    --cert ${user_certificate} \
    --key ${user_private_key} \
    --jwt ${one_time_jwt_file} \
    --out ${identity_config_file}
</code></pre><h3 id="3rd-party-ca---auto">3rd Party CA - Auto</h3>
<p>When using a third party CA identity creation process in the Ziti Controller is
automatic. The act of enrolling the identity will create it. Like &quot;3rd Party CA</p>
<ul>
<li>One Time Token&quot; - this flow expects that a private key and certificate have
already been created on or distributed to the machine that is about to enroll.
The certificate presented to the Ziti Controller must be issued by a <a href="../manage/pki.html#third-party-ca-optional">third
party CA</a> that was already
imported and verified in the Ziti Controller with the
<code>isAutoCaEnrollmentEnabled</code> property set to true.</li>
</ul>
<p>Using the <code>ziti</code> CLI will also require the re-use of a permanent JWT that is unique to the external CA. The JWT
can be downloaded from the Ziti Controller from:  <code>${controller_uri}/cas/${id}/jwt</code> where <code>${controller_uri}</code> represents
the fully qualified address of the Ziti Controller api and <code>${id}</code> represents the identifier for the given third party CA.</p>
<p><strong>Example Usage:</strong></p>
<pre><code>ziti edge enroll \
    --cert ${user_certificate} \
    --key ${user_private_key} \
    --jwt ${reusable_ca_jwt_file} \
    --out ${identity_config_file}
</code></pre><p>If supplied the <code>idname</code> will be used as the name for the identity created. The default name of auto-created identities is generated from a template that uses values from the user certificate i.e. <code>[caName]-[commonName]</code>.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/openziti/ziti-doc/blob/master/docfx_project/ziti/identities/enrolling.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span class='pull-left'><span><a href='https://netfoundry.io'>©NetFoundry Inc.</a></span>&nbsp;&nbsp;<span><a href='https://www.netfoundry.io/privacy-policy'>Privacy Policy</a></span>&nbsp;&nbsp;<span><a href='https://www.netfoundry.io/legal-items'>Legal</a></span>&nbsp;&nbsp;<span><a href='https://netfoundry.zendesk.com/hc/en-us'>Support</a></span>&nbsp;&nbsp;</span><span class='pull-right'><span><a href='https://www.facebook.com/NetFoundry/' target='_blank'><img height='25' src='/images/fb.svg'></a></span>&nbsp;<span><a href='https://twitter.com/openziti' target='_blank'><img height='25' src='/images/twit.svg'></a></span>&nbsp;<span><a href='https://www.linkedin.com/company/netfoundry/' target='_blank'><img height='25' src='/images/li.svg'></a></span>&nbsp;<span><a href='https://www.youtube.com/channel/UCAsrfQasdZmp2Gq07Ej_5cQ' target='_blank'><img height='25' src='/images/yt.svg'></a></span>&nbsp;&nbsp;&nbsp;</span><br>
<!-- Place this tag in your head or just before your close body tag. -->
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
