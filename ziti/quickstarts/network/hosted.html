<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Host Ziti Anywhere | Ziti </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Host Ziti Anywhere | Ziti ">
    <meta name="generator" content="docfx 2.x">
    
    <link rel="shortcut icon" href="../../../images/favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
    <!--span>this is text</span-->
    <link href="https://fonts.googleapis.com/css2?family=Russo+One&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,400;0,600;0,700;1,400&amp;display=swap" rel="stylesheet">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../images/ziti-logo-40.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div style="display: flex;">
                    <div class="form-group" style="valign: center;position: relative;">
                      <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                    </div>
                    <div style="position: relative">
                        &nbsp;
                    </div>
                    <div style="position: relative">
                        <a href="https://github.com/openziti">
                            <img src="../../../images/github-white.svg" alt="Star us on GitHub" title="Star us on GitHub" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://openziti.discourse.group">
                            <img src="../../../images/discourse_icon_halo.svg" alt="Start a conversation on Discourse" title="Start a conversation on Discourse" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://twitter.com/openziti">
                            <img src="../../../images/twit.svg" alt="Follow us on Twitter" title="Follow us on Twitter" height="34px">
                        </a>
                    </div>
                    <div style="position: relative">
                        <a href="https://www.youtube.com/channel/UCAsrfQasdZmp2Gq07Ej_5cQ">
                            <img src="../../../images/yt.svg" alt="Watch videos about OpenZiti" title="Watch videos about OpenZiti" height="34px">
                        </a>
                    </div>
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default" name="new">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
          <div style="display:flex; align-items: center; justify-content: center; flex-direction:row; position: relative; width: 100%; text-align: center; background-color: #eb9800">
            <span style="margin-top: 5px; color: white; margin-right: 10px; height:25px">Give us a Star on GitHub</span>
            <span style="margin-top: 5px;"><a class="github-button" href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star openziti/ziti on GitHub">Star</a></span>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="host-ziti-anywhere">Host Ziti Anywhere</h1>

<p>You can absolutely choose to host your <a class="xref" href="../../overview.html#overview-of-a-ziti-network">Ziti Network</a> anywhere you like.
It is not necessary for the server to be on the open internet. If it works better for you to deploy Ziti on your 
own network, great, do that.  The only requirement to be aware of is that every piece of the a network will need to 
be able to communicate to the controller at least one edge router. If these components are all on your local network,
that&#39;s perfectly fine. Just remember, the only components able to participate on this network will need to be able to
contact the controller and at least one edge router.</p>
<p>With all that said, if you have a server on the open internet, or you are going to provision one to stand up Ziti that&#39;s
ideal. With a Zero Trust overlay network provided by Ziti, you can rest assured that your traffic is safe even when 
using commodity internet. You also do not need to worry about being on a network you trust as all networks are 
considered untrustworthy, even your work/home network!</p>
<h2 id="installation">Installation</h2>
<p>When starting out deploying a <a class="xref" href="../../overview.html#overview-of-a-ziti-network">Ziti Network</a>, we recommend you follow
and use the <code>expressInstall</code> function provided by the OpenZiti project. Once you&#39;re familiar with the network and 
the configuration options available you&#39;ll be better equipped to make changes. </p>
<h3 id="firewall">Firewall</h3>
<p>The first issue you will need to deal with is opening some ports. A network will consist of at least one controller and 
at least one edge router. Both of these components will require ports to be open. For the controller you will need to 
open two ports through your firewall, one port for the REST API, and one the control plane. Edge routers will also 
require two ports open. One for the links created between routers to form the mesh network, and one port for incoming 
client connections.</p>
<p>The ports you choose are not important but unless you change them these ports will default to the following:</p>
<p>Controller</p>
<ul>
<li>REST API: 1280 (port 8441 used below)</li>
<li>Control plane: 6262</li>
</ul>
<p>Edge Router</p>
<ul>
<li>Edge connections: 3022 (port 8442 used below)</li>
<li>Fabric links: 10080</li>
</ul>
<p>It would be reasonable to change all these ports to use ports 443 and 80 since those ports are almost <strong>always</strong> open 
outbound from all but the most strict networks. If you&#39;re going to be making connections from one of those networks, also 
verify that outbound access to these ports is available.</p>
<h2 id="express-install">Express Install</h2>
<p>With the firewall ports open you will now be able to source the script which provides the expressInstall function and 
execute it. You probably should consider DNS names before actually running the script. By default, the script will use 
the bash <code>hostname</code> function to determine a reasonable default for the PKI that will be generated as well as the 
configuration files that are output.  The script allows you to configure these values and if you are deploying to a cloud 
provider (AWS, Azure, OCI, IBM, Digital Ocean, GCP, etc.) you will almost certainly want to use the <strong>public</strong> DNS name 
of your instance. You possibly  want to override the IP address to use as well, but using DNS names is superior to using 
IP addresses in case your IP changes.</p>
<p>The quickest and easiest thing to do, is simply find your external DNS name and set it into the EXTERNAL_DNS environment 
variable. For example:</p>
<pre><code class="lang-bash">export EXTERNAL_DNS=&quot;ec2-18-100-100-100.us-east-2.compute.amazonaws.com&quot;
</code></pre><div class="NOTE"><h5>Note</h5><p>Make sure you have <code>jq</code> installed on your machine. From ubuntu that would look like:</p>
<pre><code class="lang-bash">sudo apt update &amp;&amp; sudo apt install jq -y
</code></pre></div>
<p>Once you do that, you&#39;ll be able to 
execute these commands just as 
shown to have your 
controller and 
first edge router 
configured and ready to turn on:</p>
<pre><code class="lang-bash">export EXTERNAL_IP=&quot;$(curl -s eth0.me)&quot;       
export ZITI_EDGE_CONTROLLER_IP_OVERRIDE=&quot;${EXTERNAL_IP}&quot;
export ZITI_EDGE_ROUTER_IP_OVERRIDE=&quot;${EXTERNAL_IP}&quot;
export ZITI_EDGE_CONTROLLER_HOSTNAME=&quot;${EXTERNAL_DNS}&quot;
export ZITI_EDGE_ROUTER_HOSTNAME=&quot;${EXTERNAL_DNS}&quot;
export ZITI_EDGE_CONTROLLER_PORT=8441
export ZITI_EDGE_ROUTER_PORT=8442

# now download, source, and execute the expressInstall function
source /dev/stdin &lt;&lt;&lt; &quot;$(wget -qO- https://raw.githubusercontent.com/openziti/ziti/release-next/quickstart/docker/image/ziti-cli-functions.sh)&quot;; expressInstall
</code></pre><h3 id="systemd">Systemd</h3>
<p>If the operating system you are deploying on supports it, after the commands above are run there will two other useful
functions defined in your shell which will allow you to generate a systemd file for the controller and the edge router. This
is useful to make sure the controller can restart automatically should you shutdown/restart the server. To generate these 
files run:</p>
<pre><code class="lang-bash">createControllerSystemdFile
createRouterSystemdFile &quot;${ZITI_EDGE_ROUTER_RAWNAME}&quot;

# example:
ubuntu@ip-172-31-23-18:~$ createControllerSystemdFile
Controller systemd file written to: /home/ubuntu/.ziti/quickstart/ip-172-31-23-18/ip-172-31-23-18-edge-controller.service
ubuntu@ip-172-31-23-18:~$ createRouterSystemdFile &quot;${ZITI_EDGE_ROUTER_RAWNAME}&quot;
Router systemd file written to: /home/ubuntu/.ziti/quickstart/ip-172-31-23-18/ip-172-31-23-18-edge-router.service
ubuntu@ip-172-31-23-18:~$
</code></pre><p>After the files are generated, you can then install them for use by systemd by running:</p>
<pre><code class="lang-bash">sudo cp &quot;${ZITI_HOME}/${ZITI_EDGE_CONTROLLER_RAWNAME}.service&quot; /etc/systemd/system/ziti-controller.service
sudo cp &quot;${ZITI_HOME}/${ZITI_EDGE_ROUTER_RAWNAME}.service&quot; /etc/systemd/system/ziti-router.service
sudo systemctl daemon-reload
sudo systemctl start ziti-controller
sudo systemctl start ziti-router
</code></pre><p>Now, both the controller and the edge router will restart automatically!  After a few seconds you can then run these 
commands and verify systemd has started the processes and see the status:</p>
<pre><code class="lang-bash">sudo systemctl -q status ziti-controller --lines=0 --no-pager
sudo systemctl -q status ziti-router --lines=0 --no-pager

● ziti-controller.service - Ziti-Controller
     Loaded: loaded (/etc/systemd/system/ziti-controller.service; disabled; vendor preset: enabled)
     Active: active (running) since Thu 2021-11-11 19:05:46 UTC; 8s ago
   Main PID: 2375 (ziti-controller)
      Tasks: 7 (limit: 1154)
     Memory: 43.7M
     CGroup: /system.slice/ziti-controller.service
             └─2375 /home/ubuntu/.ziti/quickstart/ip-10-0-0-1/ziti-bin/ziti-v0.22.11/ziti-controller run /home/ubuntu/.ziti/quickstart/ip-10-0-0-1/co…
ubuntu@ip-10-0-0-1:~$ sudo systemctl -q status ziti-router --lines=0 --no-pager
● ziti-router.service - Ziti-Router for ip-10-0-0-1-edge-router
     Loaded: loaded (/etc/systemd/system/ziti-router.service; disabled; vendor preset: enabled)
     Active: active (running) since Thu 2021-11-11 19:05:47 UTC; 8s ago
   Main PID: 2385 (ziti-router)
      Tasks: 6 (limit: 1154)
     Memory: 231.4M
     CGroup: /system.slice/ziti-router.service
             └─2385 /home/ubuntu/.ziti/quickstart/ip-10-0-0-1/ziti-bin/ziti-v0.22.11/ziti-router run /home/ubuntu/.ziti/quickstart/ip-10-0-0-1/ip-10…
</code></pre><h2 id="adding-environment-variables-back-to-the-shell">Adding Environment Variables Back to the Shell</h2>
<p>If you log out and log back in again you can source the &#39;.env&#39; file located at: 
<code>. ~/.ziti/quickstart/$(hostname)/$(hostname).env</code>. Below is an example of logging in, not having ZITI_HOME set, sourcing the
.env file and then showing ZITI_HOME set:</p>
<pre><code class="lang-bash">Last login: Thu May 20 11:36:25 2021 from 67.246.244.61
ubuntu@ip-10-0-0-1:~$ echo $ZITI_HOME

ubuntu@ip-10-0-0-1:~$ . ~/.ziti/quickstart/$(hostname)/$(hostname).env

adding /home/ubuntu/.ziti/quickstart/ip-10-0-0-1/ziti-bin/ziti-v0.20.2 to the path
ubuntu@ip-10-0-0-1:~$ echo $ZITI_HOME
/home/ubuntu/.ziti/quickstart/ip-10-0-0-1
</code></pre><h2 id="install-ziti-admin-console-zac-optional">Install Ziti Admin Console (ZAC) [Optional]</h2>
<p>Once you have the network up and running, if you want to install the UI management console, the ZAC, <a href="../zac/installation.html">follow along with
the installation guide</a></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/openziti/ziti-doc/blob/master/docfx_project/ziti/quickstarts/network/hosted.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span class='pull-left'><span><a href='https://netfoundry.io'>©2020 NetFoundry,Inc.</a></span>&nbsp;&nbsp;<span><a href='https://www.netfoundry.io/privacy-policy'>Privacy Policy</a></span>&nbsp;&nbsp;<span><a href='https://www.netfoundry.io/legal-items'>Legal</a></span>&nbsp;&nbsp;<span><a href='https://netfoundry.zendesk.com/hc/en-us'>Support</a></span>&nbsp;&nbsp;</span><span class='pull-right'><span><a href='https://www.facebook.com/NetFoundry/' target='_blank'><img height='25' src='/images/fb.svg'></a></span>&nbsp;<span><a href='https://twitter.com/openziti' target='_blank'><img height='25' src='/images/twit.svg'></a></span>&nbsp;<span><a href='https://www.linkedin.com/company/netfoundry/' target='_blank'><img height='25' src='/images/li.svg'></a></span>&nbsp;<span><a href='https://www.youtube.com/channel/UCAsrfQasdZmp2Gq07Ej_5cQ' target='_blank'><img height='25' src='/images/yt.svg'></a></span>&nbsp;&nbsp;&nbsp;</span><br>
<!-- Place this tag in your head or just before your close body tag. -->
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
