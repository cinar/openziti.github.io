"use strict";(self.webpackChunkopen_ziti=self.webpackChunkopen_ziti||[]).push([[7961],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=d(n),h=a,m=u["".concat(l,".").concat(h)]||u[h]||p[h]||o;return n?i.createElement(m,r(r({ref:t},c),{},{components:n})):i.createElement(m,r({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,r[1]=s;for(var d=2;d<o;d++)r[d]=n[d];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3092:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var i=n(7462),a=(n(7294),n(3905));const o={},r="Edge APIs",s={unversionedId:"rest/edge-apis",id:"rest/edge-apis",title:"Edge APIs",description:"The Edge in Ziti currently has two APIs that it provides for configuration:",source:"@site/docs-api/rest/edge-apis.md",sourceDirName:"rest",slug:"/rest/edge-apis",permalink:"/api/rest/edge-apis",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"rootSidebar",previous:{title:"Ziti Controlller REST API",permalink:"/api/rest/"},next:{title:"Fabric APIs",permalink:"/api/rest/fabric-apis"}},l={},d=[{value:"Specifications &amp; Documentation",id:"specifications--documentation",level:2},{value:"Edge Management API",id:"edge-management-api",level:2},{value:"Edge Client API",id:"edge-client-api",level:2},{value:"Edge Client &amp; Management Shared Capabilities",id:"edge-client--management-shared-capabilities",level:2},{value:"Configuring",id:"configuring",level:2},{value:"Edge Configuration Section",id:"edge-configuration-section",level:3},{value:"Example Edge Configuration Section",id:"example-edge-configuration-section",level:4},{value:"Web Configuration Section",id:"web-configuration-section",level:3},{value:"Example Web Configuration Section",id:"example-web-configuration-section",level:4}],c={toc:d};function p(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"edge-apis"},"Edge APIs"),(0,a.kt)("p",null,"The Edge in Ziti currently has two APIs that it provides for configuration:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Edge Management API"),(0,a.kt)("li",{parentName:"ul"},"Edge Client API")),(0,a.kt)("h2",{id:"specifications--documentation"},"Specifications & Documentation"),(0,a.kt)("p",null,"Both the Edge Management and Client APIs have Open API 2.0 specifications. The most up-to-date versions of them are\navailable within the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/edge/tree/main/specs"},"Ziti Edge GitHub repository"),". They are also\navailable from a running controller directly at:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"https://\\<host",">",":\\<port",">","/edge/client/v1/docs"),(0,a.kt)("li",{parentName:"ul"},"https://\\<host",">",":\\<port",">","/edge/management/v1/docs")),(0,a.kt)("p",null,"Where ",(0,a.kt)("inlineCode",{parentName:"p"},"<host>:<port>")," should be replaced with the values configured for the APIs in the ",(0,a.kt)("a",{parentName:"p",href:"#web-configuration-section"},(0,a.kt)("inlineCode",{parentName:"a"},"web")," section")),(0,a.kt)("h2",{id:"edge-management-api"},"Edge Management API"),(0,a.kt)("p",null,"The Edge Management API is used by clients that wish to configure a Ziti network and does not facilitate to interacting\nwith service for dialing (connecting) nor binding (hosting). The Edge Management API provides the ability to create\nnew identities, identities, policies, and other entities used to manage a Ziti network."),(0,a.kt)("h2",{id:"edge-client-api"},"Edge Client API"),(0,a.kt)("p",null,"The Edge Client API is used by clients that wish to dial (connect) or bind (host) services. The services that the\nclients are allowed to interact with is defined by ",(0,a.kt)("a",{parentName:"p",href:"/docs/core-concepts/security/authorization/policies/overview"},"policies"),". In order\nfor clients to use the client API they must first ",(0,a.kt)("a",{parentName:"p",href:"/docs/core-concepts/security/authentication/auth"},"authenticate")," and\nobtain either a ",(0,a.kt)("a",{parentName:"p",href:"/docs/core-concepts/security/authentication/auth#full-vs-partial-authentication"},"partial or fully authenticated"),"\n",(0,a.kt)("a",{parentName:"p",href:"/docs/core-concepts/security/sessions#"},"API Sessioon"),"."),(0,a.kt)("h2",{id:"edge-client--management-shared-capabilities"},"Edge Client & Management Shared Capabilities"),(0,a.kt)("p",null,"The Client and Management APIs both follow the ",(0,a.kt)("a",{parentName:"p",href:"./shared-api-capabilities"},"shared API capabilities")," common on\nall Ziti APIs. Additionally, between the two the following endpoint paths are exposed on both."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"current-identity")," - facilitates the ",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"/edge/management/v1/current-identity/*"),(0,a.kt)("li",{parentName:"ul"},"/edge/client/v1/current-api-session/*"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"current-api-session"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"/edge/client/v1/current-api-session/*"),(0,a.kt)("li",{parentName:"ul"},"/edge/management/v1/current-api-session/*")))),(0,a.kt)("h2",{id:"configuring"},"Configuring"),(0,a.kt)("p",null,"In order for the Edge Client and Management API to be available a controller must be configured to enable them. This\nrequires two configuration sections ",(0,a.kt)("inlineCode",{parentName:"p"},"edge")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"web"),". The ",(0,a.kt)("inlineCode",{parentName:"p"},"edge")," section configures values that will affect  both the\nEdge Client API and the Edge Management API. The ",(0,a.kt)("inlineCode",{parentName:"p"},"web")," section is used to configure and compose any of Ziti's\nAPIs, Edge Client and Management included, to listen on any combination of network interface and ports."),(0,a.kt)("h3",{id:"edge-configuration-section"},"Edge Configuration Section"),(0,a.kt)("p",null,"The main ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/ziti"},"Ziti GitHub repository")," has",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/ziti/blob/release-next/etc/"},"example configuration"),"\nfiles. The ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl.with.edge.yml")," file has all of the ",(0,a.kt)("inlineCode",{parentName:"p"},"edge")," values documented."),(0,a.kt)("h4",{id:"example-edge-configuration-section"},"Example Edge Configuration Section"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"edge:\n  api:\n    #(optional, default 90s) Alters how frequently heartbeat and last activity values are persisted\n    # activityUpdateInterval: 90s\n    #(optional, default 250) The number of API Sessions updated for last activity per transaction\n    # activityUpdateBatchSize: 250\n    # sessionTimeout - optional, default 10m\n    # The number of minutes before an Edge API session will timeout. Timeouts are reset by\n    # API requests and connections that are maintained to Edge Routers\n    sessionTimeout: 30m\n    # address - required\n    # The default address (host:port) to use for enrollment for the Client API. This value must match one of the addresses\n    # defined in a bind point's address field for the `edge-client` API in the web section.\n    address: 127.0.0.1:1280\n  # enrollment - required\n  # A section containing settings pertaining to enrollment.\n  enrollment:\n    # signingCert - required\n    # A Ziti Identity configuration section that specifically makes use of the cert and key fields to define\n    # a signing certificate from the PKI that the Ziti environment is using to sign certificates. The signingCert.cert\n    # will be added to the /.well-known CA store that is used to bootstrap trust with the Ziti Controller.\n    signingCert:\n      cert: ./ziti/etc/ca/intermediate/certs/intermediate.cert.pem\n      key: ./ziti/etc/ca/intermediate/private/intermediate.key.pem\n    # edgeIdentity - optional\n    # A section for identity enrollment specific settings\n    edgeIdentity:\n      # duration - optional, default 5m\n      # The length of time that a Ziti Edge Identity enrollment should remain valid. After\n      # this duration, the enrollment will expire and not longer be usable.\n      duration: 5m\n    # edgeRouter - Optional\n    # A section for edge router enrollment specific settings.\n    edgeRouter:\n      # duration - optional, default 5m\n      # The length of time that a Ziti Edge Router enrollment should remain valid. After\n      # this duration, the enrollment will expire and not longer be usable.\n      duration: 5m\n")),(0,a.kt)("h3",{id:"web-configuration-section"},"Web Configuration Section"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"web")," section of the controller is based off of the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/xweb"},"xweb")," library. xweb allows\na single configuration section to be used to compose multiple APIs across any number of network interfaces. Understanding\nthe xweb configuration format is essential for success with configuring the ",(0,a.kt)("inlineCode",{parentName:"p"},"web")," section in the controller."),(0,a.kt)("p",null,"Ziti Edge exposes the following two xweb API bindings:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"edge-client")," - the Edge Client API"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"edge-management")," - the Edge Management API")),(0,a.kt)("p",null,"Neither have any associated options in the ",(0,a.kt)("inlineCode",{parentName:"p"},"web")," section."),(0,a.kt)("h4",{id:"example-web-configuration-section"},"Example Web Configuration Section"),(0,a.kt)("p",null,"The main ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/ziti"},"Ziti GitHub repository")," has",(0,a.kt)("a",{parentName:"p",href:"https://github.com/openziti/ziti/blob/release-next/etc/"},"example configuration"),"\nfiles. The ",(0,a.kt)("inlineCode",{parentName:"p"},"ctrl.with.edge.yml")," file has all of the ",(0,a.kt)("inlineCode",{parentName:"p"},"web")," values documented."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'# web - optional\n# Defines webListeners that will be hosted by the controller. Each webListener can host many APIs and be bound to many\n# bind points.\nweb:\n# name - required\n# Provides a name for this listener, used for logging output. Not required to be unique, but is highly suggested.\n- name: all-apis-localhost\n  # bindPoints - required\n  # One or more bind points are required. A bind point specifies an interface (interface:port string) that defines\n  # where on the host machine the webListener will listen and the address (host:port) that should be used to\n  # publicly address the webListener(i.e. mydomain.com, localhost, 127.0.0.1). This public address may be used for\n  # incoming address resolution as well as used in responses in the API.\n  bindPoints:\n  #interface - required\n  # A host:port string on which network interface to listen on. 0.0.0.0 will listen on all interfaces\n    - interface: 127.0.0.1:1280\n\n      # address - required\n      # The public address that external incoming requests will be able to resolve. Used in request processing and\n      # response content that requires full host:port/path addresses.\n      address: 127.0.0.1:1280\n\n      # newAddress - optional\n      # A host:port string which will be sent out as an HTTP header "ziti-new-address" if specified. If the header\n      # is present, clients should update location configuration to immediately use the new address for future\n      # connections. The value of newAddress must be resolvable both via DNS and validate via certificates\n      newAddress: localhost:1280\n  # identity - optional\n  # Allows the webListener to have a specific identity instead of defaulting to the root `identity` section.\n  #    identity:\n  #      cert:                 ${ZITI_SOURCE}/ziti/etc/ca/intermediate/certs/ctrl-client.cert.pem\n  #      server_cert:          ${ZITI_SOURCE}/ziti/etc/ca/intermediate/certs/ctrl-server.cert.pem\n  #      key:                  ${ZITI_SOURCE}/ziti/etc/ca/intermediate/private/ctrl.key.pem\n  #      ca:                   ${ZITI_SOURCE}/ziti/etc/ca/intermediate/certs/ca-chain.cert.pem\n  # options - optional\n  # Allows the specification of webListener level options - mainly dealing with HTTP/TLS settings. These options are\n  # used for all http servers started by the current webListener.\n  options:\n  # idleTimeout - optional, default 5000ms\n  # The maximum amount of idle time in milliseconds allowed for pipelined HTTP requests. Setting this too high\n  # can cause resources on the host to be consumed as clients remain connected and idle. Lowering this value\n  # will cause clients to reconnect on subsequent HTTPs requests.\n  idleTimeout: 5000ms  #http timeouts, new\n\n  # readTimeout - optional, default 5000ms\n  # The maximum amount of time in milliseconds http servers will wait to read the first incoming requests. A higher\n  # value risks consuming resources on the host with clients that are acting bad faith or suffering from high latency\n  # or packet loss. A lower value can risk losing connections to high latency/packet loss clients.\n\n  readTimeout: 5000ms\n  # writeTimeout - optional, default 10000ms\n  # The total maximum time in milliseconds that the http server will wait for a single requests to be received and\n  # responded too. A higher value can allow long running requests to consume resources on the host. A lower value\n  # can risk ending requests before the server has a chance to respond.\n\n  writeTimeout: 100000ms\n  # minTLSVersion - optional, default TSL1.2\n  # The minimum version of TSL to support\n\n  minTLSVersion: TLS1.2\n  # maxTLSVersion - optional, default TSL1.3\n  # The maximum version of TSL to support\n\n  maxTLSVersion: TLS1.3\n  # apis - required\n  # Allows one or more APIs to be bound to this webListener\n  apis:\n  # binding - required\n  # Specifies an API to bind to this webListener. Built-in APIs are\n  #   - health-checks\n  #   - edge-management\n  #   - edge-client\n  #   - fabric-management\n    - binding: health-checks\n      options: { }\n    - binding: fabric\n    - binding: edge-management\n      # options - variable optional/required\n      # This section is used to define values that are specified by the API they are associated with.\n      # These settings are per API. The example below is for the `edge-api` and contains both optional values and\n      # required values.\n      options: { }\n    - binding: edge-client\n      options: { }\n')))}p.isMDXComponent=!0}}]);